alias: test-model-ssd-resnet50-cognata-pytorch-training
uid: 49c05ac0d0454373

automation_alias: script
automation_uid: 5b4e0237da074764

private: true

category: Tests

tags:
- test
- abtf
- ssd-resnet50
- cognata
- pytorch
- training

input_mapping:
  model: CM_ML_MODEL_FILE_WITH_PATH
  config: CM_ABTF_ML_MODEL_CONFIG
  dataset: CM_ABTF_DATASET
  num_classes: CM_ABTF_NUM_CLASSES

default_env:
  CM_ABTF_ML_MODEL_CONFIG: baseline_8MP
  CM_ABTF_DATASET: Cognata

deps:

- tags: detect,os

- tags: get,python3
  names:
  - python
  - python3

########################################################################
- tags: get,generic-python-lib,_numpy
- tags: get,generic-python-lib,_package.typing-extensions
- tags: get,generic-python-lib,_package.sympy
- tags: get,generic-python-lib,_package.Pillow
- tags: get,generic-python-lib,_opencv-python

- tags: get,generic-python-lib,_package.tensorboard
- tags: get,generic-python-lib,_package.tqdm
- tags: get,generic-python-lib,_package.pycocotools
- tags: get,generic-python-lib,_package.apex



########################################################################
- tags: get,dataset,raw,mlcommons-cognata
  names:
  - raw-dataset-mlcommons-cognata

########################################################################
# Install PyTorch for CPU or CUDA

- enable_if_env:
    CM_DEVICE:
    - cpu
  tags: get,generic-python-lib,_torch
  names:
  - torch

- enable_if_env:
    CM_DEVICE:
    - cpu
  tags: get,generic-python-lib,_torchvision
  names:
  - torchvision

# CUDA

- enable_if_env:
    CM_DEVICE:
    - cuda
  tags: get,generic-python-lib,_torch_cuda
  names:
  - torch

- enable_if_env:
    CM_DEVICE:
    - cuda
  tags: get,generic-python-lib,_torchvision_cuda
  names:
  - torchvision


- tags: get,ml-model,abtf-ssd-pytorch
  names:
  - ml-model



############################################################
variations:
  cpu:
    group: device
    default: True
    env:
      CM_DEVICE: cpu

  cuda:
    docker:
      all_gpus: 'yes'
      base_image: nvcr.io/nvidia/pytorch:24.03-py3
    group:
      device
    env:
      CM_DEVICE: cuda


############################################################
input_description:
  input: 
    desc: input image (png)
  output: 
    desc: output image (png)
  export_model: 
    desc: ONNX model name to be exported from PyTorch
  num-classes: 
    desc: change number of classes (default = 13)

